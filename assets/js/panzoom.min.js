function PanZoom(t,e){let n=[],i=(e=e||{}).minScale?e.minScale:.1,a=e.maxScale?e.maxScale:5,s=e.increment?e.increment:.05,l=!!e.liner&&e.liner;return document.querySelectorAll(t).forEach(function(t){n.push(new AttachPanZoom(t,i,a,s,l))}),1==n.length?n[0]:n}function AttachPanZoom(t,e,n,i,a){this.increment=i,this.minScale=e,this.maxScale=n,this.liner=a,this.panning=!1,this.oldX=this.oldY=0;let s=this;t.style.transform="matrix(1, 0, 0, 1, 0, 0)",this.getTransformMatrix=function(){let e=t.style.transform,n=e.indexOf("(")+1,i=e.indexOf(")"),a=e.slice(n,i).split(",");return{scale:+a[0],transX:+a[4],transY:+a[5]}},this.setTransformMatrix=function(e){t.style.transform="matrix("+e.scale+", 0, 0, "+e.scale+", "+e.transX+", "+e.transY+")"},this.applyTranslate=function(t,e){let n=this.getTransformMatrix();n.transX+=t,n.transY+=e,this.setTransformMatrix(n)},this.applyScale=function(e,n,i){let a=this.getTransformMatrix(),s=n-t.width/2,l=i-t.height/2;e=this.liner?e:e*a.scale,a.scale+=e;let r=a.scale<=this.minScale||a.scale>=this.maxScale;a.scale<this.minScale&&(a.scale=this.minScale),a.scale>this.maxScale&&(a.scale=this.maxScale),r||(this.applyTranslate(s,l),this.setTransformMatrix(a),this.applyTranslate(-s*e,-l*e))},t.addEventListener("mousedown",function(t){t.preventDefault(),this.panning=!0,this.oldX=t.clientX,this.oldY=t.clientY}),t.addEventListener("mouseup",function(t){this.panning=!1}),t.addEventListener("mouseleave",function(t){this.panning=!1}),t.addEventListener("mousemove",function(t){if(this.panning){let e=t.clientX-this.oldX,n=t.clientY-this.oldY;s.applyTranslate(e,n),this.oldX=t.clientX,this.oldY=t.clientY}}),this.getScrollDirection=function(t){Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))<0?s.applyScale(-s.increment,t.offsetX,t.offsetY):s.applyScale(s.increment,t.offsetX,t.offsetY)},t.addEventListener("DOMMouseScroll",this.getScrollDirection,!1),t.addEventListener("mousewheel",this.getScrollDirection,!1)}
